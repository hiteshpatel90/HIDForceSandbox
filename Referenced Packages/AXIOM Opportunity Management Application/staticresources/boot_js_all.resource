/*! bootstrapResources 18-04-2014 */
function changeWinData(a){Visualforce.remoting.Manager.invokeAction(controller+".getWinProbability",parentId,function(b){1==b&&renderWinData(a)},{escape:!0})}function renderWinData(a){Visualforce.remoting.Manager.invokeAction(controller+".createWinProbabilityChartWithIndicator",parentId,"Win Probability",urlImage,function(b){var c=FusionCharts($("#Win-radar").children().prop("id"));c.setJSONData(b),null!=a&&$("."+a).trigger("refreshDepend")},{escape:!0})}function rerenderWinFunc(){Visualforce.remoting.Manager.invokeAction(controller+".createWinProbabilityChartWithIndicator",parentId,"Win Probability",urlImage,function(a){FusionCharts.setCurrentRenderer("javascript");var b=new FusionCharts({type:"AngularGauge",width:.75*$(".summary-win").width()>190?.75*$(".summary-win").width():190,height:"110px",debugMode:!1,registerWithJS:"0"});b.setJSONData(a),b.render("Win-radar");var c=!1;b.addEventListener("DrawComplete",function(){if(/(msie|ie)/.test(navigator.userAgent.toLowerCase())&&!c){c=!0,$("#Win-radar").children().width($("#Win-radar").width());var a=getChartFromId($("#Win-radar").children().prop("id"));null!=a&&getChartFromId($("#Win-radar").children().prop("id")).render()}})},{escape:!0})}function validateAccess(a){var b=jQuery(a.target),c=b.parents(".component-button"),d=jQuery(b.attr("href"));if(!isUpdateableParent){b.removeClass("saving"),b.removeClass("deleting"),c.removeClass("busy");var e=d.find(".SaveObj");e.find(".error-message").show(),e.find(".error-message").html("You do not have permissions to update this "+ObjectType+".")}return isUpdateableParent}function getCSS(a){jQuery.ajax({url:tempDir[a].css,success:function(a){a=a.replace(/url\(\'\/resource\/axiom_base__images\//g,"url('"+imagePrefix),jQuery("#css").append(a),pdfCSS+=a,++cssLoaded,cssLoaded>=totalCSS&&(jQuery("#css").html("<style>"+jQuery("#css").html()+"</style>"),pdfCSS="<style>"+pdfCSS+"</style>",boot())}})}function loadParentObject(a){loadCurrency(),$("#CloseDate").datepicker({dateFormat:"M dd, yy",showOn:"button",buttonImage:calendarURL,buttonImageOnly:!0}),matchHeightsHeader(".summary-item"),$(window).resize(function(){matchHeightsHeader(".summary-item"),matchChartWidth()});var b=jQuery(".summary-"+ObjectType+"-stage .edit select"),c=0,d=0;b.val(b.attr("current")),editDOM(function(){jQuery(".summary-"+ObjectType+"-stage .edit").show(),noFancies||(b.chosen(),jQuery(".summary-"+ObjectType+"-stage .edit .chzn-container input").addClass("noEnterSave")),jQuery(".summary-close-date .edit .dateFormat").addClass("hidden"),jQuery(".summary-close-date .edit input").attr("name","CloseDate"),jQuery(".summary-"+ObjectType+"-stage .edit").hide(),c=jQuery(".header-description .view .desc").height(),jQuery(".header-description .view .desc").addClass("fullDesc").removeClass("shortDesc"),d=jQuery(".header-description .view .desc").height(),jQuery(".header-description .view .desc").addClass("shortDesc").removeClass("fullDesc"),matchHeights(".summary-wrapper .summary-item-content")}),d>c?(jQuery(".header-description .view .show .more").click(function(a){a.preventDefault(),a.stopPropagation(),jQuery(".header-description .view .shortDesc").removeClass("shortDesc").addClass("fullDesc")}),jQuery(".header-description .view .show .less").click(function(a){a.preventDefault(),a.stopPropagation(),jQuery(".header-description .view .fullDesc").removeClass("fullDesc").addClass("shortDesc")})):jQuery(".header-description .view .show").hide();var e=function(){var a=jQuery(this);-1==a.attr("class").indexOf("item")&&(a=jQuery(this).parent().parent().children(".item"));{var b=a.attr("api-name"),c=a.val(),d=a.parents(".edit");d.siblings(".view")}return(""==c||null==c)&&(c=a.attr("default"),null==c&&(c="")),a.hasClass("date")&&(c=$.datepicker.formatDate("yy-mm-dd",new Date(c))),!jQuery(this).hasClass("noLimit")&&c.length>255?void d.find(".error-message").html("Max length 255. Currently "+c.length+"."):void Visualforce.remoting.Manager.invokeAction(controller+".saveObj",ObjectType,parentId,"",encodeURIComponent(b)+"="+encodeURIComponent(c),function(a){if(null==a)return void(window.location.href="/"+parentId);jQuery("."+ObjectType+" .header .error-message").html("");var b=a.split(":",2);if("ID"==b[0])reRenderParentObj(),jQuery(".dangerZones .refresh-button").click();else if("ERROR"==b[0]){var c=b[1].split("|",2);jQuery("."+ObjectType+" .header .error-message").html("ERROR: "+c[1]+". This error could be caused by a validation rule on the "+ObjectType+". To edit the "+ObjectType+', <a href="/'+parentId+"/e?retURL=%2F"+parentId+'">click here</a>')}})};jQuery("."+ObjectType+"-item .edit .item.change").bind("change",e),jQuery("."+ObjectType+"-item .edit .save").bind("click",e),jQuery("."+ObjectType+"-item .edit .cancel").click(function(){var a=jQuery(this).parents(".edit"),b=a.siblings(".view"),c=jQuery(this).parents(".edit").children(".item");null!=c&&("StageName"==c.attr("name")?(c.val(parentStage),c.trigger("liszt:updated")):"CloseDate"==c.attr("name")&&c.val(parentCloseDate)),a.hide(),b.show()}),jQuery("."+ObjectType+"-item .edit .item.blur").bind("blur",e),jQuery("."+ObjectType+"-item .view").click(function(){var a=jQuery(this),b=a.siblings(".edit"),c=b.find(".item"),d=c.attr("id");if(a.hide(),b.show(),null!=d)try{jQuery("#"+d).focus(),jQuery("#"+d+"_chzn .chzn-single").mousedown()}catch(e){}else c.focus()}),jQuery(".summary-data input.item").bind("keypress",function(a){var b=jQuery(this);13==a.keyCode&&b.hasClass("blur")&&b.blur()}),"function"!=typeof a||done||a()}function matchHeightCollapsed(){var a=jQuery(".commonalities"),b=jQuery(".decisionHistory");"none"!=a.find(".component-body").css("display")||"none"!=b.find(".component-body").css("display")?"none"!=a.find(".component-body").css("display")&&"none"==b.find(".component-body").css("display")?(b.css("height","43px"),a.css("height","")):"none"==a.find(".component-body").css("display")&&"none"!=b.find(".component-body").css("display")&&(a.css("height","43px"),b.css("height","")):(b.css("height",""),a.css("height",""))}function matchHeights(a){try{var b=0;jQuery(a).height("auto"),jQuery(a).each(function(){var a=jQuery(this).height();a>b&&(b=a)}),jQuery(a).height(b),matchHeightCollapsed()}catch(c){}}function matchHeightsHeader(a){try{var b=0;jQuery(a).height("auto"),jQuery(a).each(function(){var a=jQuery(this).outerHeight();a>b&&(b=a)}),jQuery(a).height(b)}catch(c){}}function matchChartWidth(){var a=.75*$(".summary-win").width()>190?.75*$(".summary-win").width():190;try{getChartFromId($("#Win-radar").children().prop("id")).resizeTo(a,"110px")}catch(b){}}function getSecFromCookies(a){var b=jQuery.cookie("sid");b=b.substring(20,26);var c=jQuery.cookie(b+"_"+parentId+"_cookie");if(null!=c&&""!=c)for(var d=c.split(";"),e=0;e+1<d.length;e++){if("actionRegistersOpportunity"==d[e])jQuery("#"+d[e]).css("display","block"),matchHeights(".small-component-group-1");else{var f="."+d[e]+" .component-footer-wrapper";jQuery(f).css("display","block")}var f="."+d[e]+" .component-body";if(jQuery(f).css("display","block"),("decisionHistory"==d[e]||"commonalities"==d[e])&&matchHeights(".small-component-group-2"),!a){var g="."+d[e]+" .loader2";jQuery(g).css("display","block")}}}function postPageLoad(){if(++componentsLoaded,evLoad&&firstTime){firstTime=!1,evload=!1;try{++totalComponents,loadDangerZones(function(){})}catch(a){postPageLoad()}try{++totalComponents,loadPSCCriteria(function(){})}catch(a){postPageLoad()}try{++totalComponents,loadFinancialCriteria(function(){})}catch(a){--totalComponents}try{++totalComponents,loadDecisionHistory(function(){})}catch(a){postPageLoad()}try{loadBusinessStates(function(){})}catch(a){postPageLoad()}}if(!done&&componentsLoaded>9){if(getSecFromCookies(done),done=!0,jQuery(".loader").hide(),jQuery("."+ObjectType).removeClass("hidden").show(),jQuery(".chatter").removeClass("hidden"),jQuery(".details").removeClass("hidden"),rerenderWinFunc(),$("#Win-radar").attr("style","width: 265px"),/(msie|ie)/.test(navigator.userAgent.toLowerCase())){$("#Win-radar").children().width($("#Win-radar").width());var b=getChartFromId($("#Win-radar").children().prop("id"));null!=b&&getChartFromId($("#Win-radar").children().prop("id")).render()}matchHeights(".summary-wrapper .summary-item-content"),matchHeights(".small-component-group-1"),matchHeights(".small-component-group-2"),matchHeightsHeader(".summary-item"),matchChartWidth(),jQuery(window).resize(function(){matchHeights(".summary-wrapper .summary-item-content"),matchHeights(".small-component-group-1"),matchHeights(".small-component-group-2"),jQuery("."+ObjectType+" .component-body-item.edit").addClass("_edit"),jQuery("."+ObjectType+" .component-body-item").addClass("edit"),jQuery(".chzn-done").each(function(){var a=jQuery(this);a.removeClass(".chzn-done")}),jQuery("."+ObjectType+" .component-body-item").removeClass("edit"),jQuery("."+ObjectType+" .component-body-item._edit").addClass("edit").removeClass("_edit")}),jQuery(".handlebarContainer").mouseup(function(){jQuery(".chzn-done").each(function(){var a=jQuery(this);a.removeClass(".chzn-done"),a.chosen(),a.siblings(".chzn-container").find("input").addClass("noEnterSave")})});var c=jQuery("#pdf-button"),d=jQuery("#pdf-link");d.click(function(){window.open(jQuery(this).attr("href"))}),c.click(function(){if(!c.hasClass("creating")){d.attr("href",""),c.addClass("creating"),c.find(".printpdf").hide(),c.find(".loadpdf").show(),jQuery("body").append('<div id="pdfContent" class="'+ObjectType+' pdf hidden"></div');var a=jQuery("."+ObjectType).html();a=a.replace('Id="','Id=" '),jQuery("#pdfContent").html(a),jQuery("#pdfContent #chart_div").remove(),jQuery("#pdfContent .edit").remove(),jQuery("#pdfContent .new").remove(),jQuery("#pdfContent .no-pdf").remove(),jQuery("#pdfContent .component-button").remove(),jQuery("#pdfContent .fusionChart").remove();var b="",b='<div class="summary-item-content" style="text-align:left !important">';b+='<div class="summary-item-label">Win Probability</div>',b+='<div class=" value left" style="font-size:14px;font-weight:bold;line-height:22px;">',b+=getChartFromId($("#Win-radar").children().prop("id")).getData(1)+"%",b+='<div class="summary-arrow right">',b+='<img src="'+getChartFromId($("#Win-radar").children().prop("id")).getJSONData().annotations.groups[0].items[2].url+'"/>',b+="</div></div></div>",jQuery("#pdfContent .summary-win").html(b);var e=$(".shortDesc").children();null!=e&&0!=e.length&&"Add a Description"==$(e[0]).html()&&jQuery("#pdfContent .header-description").remove(),jQuery("#pdfContent").show(),matchHeights("#pdfContent .summary-wrapper .summary-item-content"),matchHeights("#pdfContent .small-component-group-1"),matchHeights(".small-component-group-2");var f="<html><head><style>@page { margin: 0; padding: 0; } #pdfContent ."+ObjectType+".pdf { width: 8.5in }</style>";f+=pdfCSS,f+='</head><body><div class="'+ObjectType+' pdf">'+jQuery("#pdfContent").html()+"</div></body></html>",jQuery("#pdfContent").remove(),Visualforce.remoting.Manager.invokeAction(controller+".savePDF",parentId,f,function(a){return null==a?void(window.location.href="/"+parentId):void(-1==a.indexOf("ERROR:")&&Visualforce.remoting.Manager.invokeAction(controller+".generatePDF",parentId,a,function(a){-1==a.indexOf("ERROR:")&&(window.location.href="/servlet/servlet.FileDownload?file="+a),c.find(".loadpdf").hide(),c.find(".printpdf").show(),c.removeClass("creating")},"false"))},"false")}}),$(".evaluators").find(".refresh-button").click(),$(".decisionStages").trigger("refreshDepend"),$(".currentPSCF").trigger("refreshDepend"),$(".commonalities").trigger("refreshDepend"),c.show()}}function editDOM(a){var b=jQuery("."+ObjectType),c=b.hasClass("hidden");c&&(jQuery(".loader").hide(),b.removeClass("hidden")),"function"==typeof a&&a(),c&&(b.addClass("hidden"),jQuery(".loader").show())}var parentModel=Backbone.Model.extend({getById:function(a,b){{var c=this;Visualforce.remoting.Manager.invokeAction(controller+".getOpportunityById",a,function(a){c.set(a),"function"==typeof b&&b()})}}}),componentDataCollection=Backbone.Collection.extend({getByParentIdAndType:function(a,b,c){function d(a){var b=new Date(a),c=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");return dat=c[b.getUTCMonth()]+" "+b.getUTCDate()+", "+b.getUTCFullYear()}var e=this;e.type=b,e.reset(),done?"actionRegisters"==b?Visualforce.remoting.Manager.invokeAction(controller+".getActionRegistersByParentId",a,"Task",function(f){_.each(f,function(a){if(null!=a.activity.ActivityDate){var c=new Date(a.activity.ActivityDate);a.activity.ActivityDate=d(c)}else taskAcitivityDate="";a.activity.type=b+"T"}),f=JSON.parse(JSON.stringify(f).replace(/AXIOMOMD__/g,"")),done&&e.add(f),Visualforce.remoting.Manager.invokeAction(controller+".getActionRegistersByParentId",a,"Event",function(a){var f=new Date;_.each(a,function(a){if(null!=a.activity.ActivityDate){var c=new Date(a.activity.ActivityDate);a.activity.ActivityDate=d(c),f>c?(a.activity.IsClosed=!0,a.IsClosed=!0):(a.activity.IsClosed=!1,a.IsClosed=!1)}else a.activity.ActivityDate="";a.activity.type=b+"U"}),a=JSON.parse(JSON.stringify(a).replace(/AXIOMOMD__/g,"")),done&&e.add(a),e.models=_.sortBy(e.models,function(a){return a.get("IsClosed")+a.get("ActivityDate")}),"function"==typeof c&&c()})}):"dangerZones"==b?Visualforce.remoting.Manager.invokeAction(controller+".getDangerZonesByParentId",a,function(a){a=JSON.parse(JSON.stringify(a).replace(/AXIOMOMD__/g,"")),done&&e.add(a),e.models=_.sortBy(e.models,function(a){return a.get("Description__c")}),"function"==typeof c&&c()},{escape:!1}):"decisionStages"==b?Visualforce.remoting.Manager.invokeAction(controller+".getDecisionStagesByParentId",a,function(a){a=JSON.parse(JSON.stringify(a).replace(/AXIOMOMD__/g,"")),_.each(a,function(a){if(null!=a.Item.Time_Frame_Date__c){var b=new Date(a.Item.Time_Frame_Date__c);a.Item.Time_Frame_Date__c=d(b)}}),decisionStatus=0!=a.length?a[0].Status:"empty",done&&e.add(a),"function"==typeof c&&c()},{escape:!1}):Visualforce.remoting.Manager.invokeAction(controller+".getComponentDataByParentIdAndType",a,b,function(a){"commonalities"==b&&(commonalityStatus=0!=a.length?-1!=controller.indexOf("opportunityExtension")?a[0].AXIOM_BASE__Opportunity__r.AXIOM_BASE__CommonalityStatus__c:a[0].AXIOM_BASE__Strategic_Initiative__r.AXIOM_BASE__CommonalityStatus__c:"empty"),"financialCriteria"==b&&_.each(a,function(a){a.AXIOM_BASE__Budget__c>0&&(a.EnableStatusBudget=!0),(a.AXIOM_BASE__Favored_Alternative_Value_Assignment__c>0||a.AXIOM_BASE__Company_Value_Assignment__c>0||a.AXIOM_BASE__Support_Value_Assignment__c>0||a.AXIOM_BASE__Product_Value_Assignment__c>0)&&(a.EnableStatusAssignment=!0),a.edit_Budget__c=a.AXIOM_BASE__Budget__c,a.AXIOM_BASE__Budget__c=accounting.formatMoney(a.AXIOM_BASE__Budget__c,isoCode)}),"evaluators"==b&&(totalAmountOfEvaluators=a.length,canCreateCCEvaluator=totalAmountOfEvaluators>1?!0:!1,evList=a,_.each(a,function(a){var b="",c=a.AXIOM_BASE__Quality_Score__c;switch(!0){case c>=0&&.8>c:a.Quality="Opponent";break;case c>=.8&&1.7>c:a.Quality="Adversary";break;case c>=1.7&&2.6>c:a.Quality="Resistor";break;case c>=2.6&&3.5>c:a.Quality="Neutral";break;case c>=3.5&&4.4>c:a.Quality="Supporter";break;case c>=4.4&&5.3>c:a.Quality="Advocate";break;case c>=5.3&&6>=c:a.Quality="Sponsor"}if(null!=a.AXIOM_BASE__Roles__c){var d=a.AXIOM_BASE__Roles__c.split(";"),e="";for(role in d)null!=rolesMap[d[role]]&&(e+=rolesMap[d[role]]+", ");a.Veiw_Roles=e.substring(0,e.length-2)}void 0===a.AXIOM_BASE__Contact__r.Account&&(a.AXIOM_BASE__Contact__r.Account={Name:"No Account"}),isAlternativeObjEmpty?(a.favoredAlternative=a.AXIOM_BASE__Favored_Alternative__c,a.favoredAlternativeName=a.AXIOM_BASE__Favored_Alternative__c):(a.favoredAlternative="",a.FavoredAlternativeName="",_.each(a.AXIOM_BASE__BIO_Worksheet_Competitors__r,function(c){""!=b&&(b+=", "),b+=c.AXIOM_BASE__Competitor__r.Name,1==c.AXIOM_BASE__Favored__c&&(a.favoredAlternative=c.AXIOM_BASE__Competitor__c,a.favoredAlternativeName=c.AXIOM_BASE__Competitor__r.Name)}),a.competitorAlternatives=b,a.AXIOM_BASE__Favored_Alternative__c==orgName&&(a.favoredAlternative=orgName,a.favoredAlternativeName=orgName))})),"decisionHistory"==b&&_.each(a,function(a){outcomeAlternatives=[],null!=a.AXIOMOMD__Outcome_Alternative__c&&_.each(a.AXIOMOMD__Outcome_Alternative__c.split(";"),function(a){null!=a&&""!=a&&outcomeAlternatives.push(a)}),a.outcomeAlternativesMultiple=outcomeAlternatives}),a=JSON.parse(JSON.stringify(a).replace(/AXIOMOMD__/g,"")),done&&e.add(a),"function"==typeof c&&c()},{escape:!1}):"function"==typeof c&&c()},getByParentId:function(a,b){var c=this;c.getByParentIdAndType(a,c.type,b)},getByAccountIdAndType:function(a,b,c,d){var e=this;e.type=b,e.reset(),Visualforce.remoting.Manager.invokeAction(controller+".getComponentDataByAccountIdAndType",a,b,c,function(a){a=JSON.parse(JSON.stringify(a).replace(/AXIOMOMD__/g,"")),e.add(a),"function"==typeof d&&d()},{escape:!1})}}),componentView=Backbone.View.extend({events:{"click .cancel-button":"cancelButton","click .component-title":"onClick","click .component-logo":"onClick","click .clear-button":"clearButton","click .delete-button":"deleteButton","click .edit-button":"editButton","click .new-button":"newButton","click .refresh-button":"refreshButton",refreshDepend:"refreshDepend","click .save-button":"saveButton","click .AXIOM_BASE__Status__c .minus":"setMinus","click .AXIOM_BASE__Status__c .plus":"setPlus","keypress input":"clickSaveButton"},renderModal:function(a){var b=this;b.collection.type&&(templates.get(tempDir[b.collection.type],function(a){b.$el.find(".component-body-item-content").html(a({model:b.collection.toJSON(),type:b.collection.type,items:b.items,options:b.options})),"Modal_Commonalities"==b.collection.type&&$("#com_filter").chosen(),b.$el.parent().parent().find(".pull-from-text").text("Pull From Existing( "+b.collection.length+" )")}),a&&(a.events&&jQuery.extend(b.events,a.events),a.duplicateErrorMsg&&(b.duplicateErrorMsg=a.duplicateErrorMsg),b.delegateEvents(b.events)))},render:function(a,b){var c=this;c.postRenderCallback=b,templates.get(tempDir.component,function(b){if(c.$el.html(b({params:a})),c.$el.find(".dropdown-toggle").dropdown(),c.$el.find(".dropdown-toggle.hidden").hide(),a.type)c.type=a.type,a.newItem&&(c.items=a.newItem.items,a.newItem.hasLightbox&&(c.hasLightbox=a.newItem.hasLightbox)),a.options&&(c.options=a.options),c.renderContent();else if("function"==typeof c.postRenderCallback){var d=c.$el.find(".component-body-item");d.addClass("edit"),noFancies?c.$el.find(".fancies").remove():(c.$el.find("select").chosen(),c.$el.find(".chzn-container input").addClass("noEnterSave"),c.$el.find(".noFancies").remove()),d.removeClass("edit"),c.postRenderCallback()}}),a.events&&jQuery.extend(c.events,a.events),a.duplicateErrorMsg&&(c.duplicateErrorMsg=a.duplicateErrorMsg),c.delegateEvents(c.events),a.dependentComponents&&(c.dependentComponents=a.dependentComponents),postPageLoad()},renderContent:function(){var a=this;a.type&&templates.get(tempDir[a.type],function(b){if(a.$el.find(".component-body").html(b({model:a.collection.toJSON(),type:a.type,items:a.items,options:a.options})),done&&a.$el.find(".new-button").removeClass("disabled"),a.$el.find(".Toggler input").each(function(){var b=jQuery(this);b.attr("checked")||a.$el.find(b.val()).hide()}),"function"==typeof a.postRenderCallback){var c=a.$el.find(".component-body-item");editDOM(function(){c.addClass("edit");try{a.$el.find("select").each(function(){var a=jQuery(this),b=a.attr("current"),c=a.attr("multiple");null!=b&&(a.val(b),c&&0!=c&&a.val(b.split(";")),a.change(),a.trigger("liszt:updated"))}),a.$el.find("input").each(function(){var a=jQuery(this),b=a.attr("current");null!=b&&a.val(b)}),noFancies?a.$el.find(".fancies").remove():(a.$el.find("select").chosen(),a.$el.find(".chzn-container input").addClass("noEnterSave"),a.$el.find(".noFancies").remove())}catch(b){}c.removeClass("edit")}),done&&($("."+a.type+" .loader2").hide(),$("."+a.type+" .component-body-header").show()),a.postRenderCallback()}})},cancelButton:function(a){a.preventDefault();var b=jQuery(a.target),c=b.parents(".component-button"),d=(c.find(".buttons"),c.find(".busy"),jQuery(b.attr("href")));b.hasClass("canceling")||(b.addClass("canceling"),c.addClass("busy"),d.find(".item").each(function(){var a=jQuery(this),b=a.attr("current"),c=a.attr("multiple");null!=b&&(a.val(b),a.is("select")&&c&&0!=c&&a.val(b.split(";")),a.change(),a.trigger("liszt:updated"))}),d.find(".component-body-item-field").removeClass("error"),d.find(".component-body-item-field .error-message").html(""),d.find("input.clearItem").val(""),d.removeClass("edit"),b.removeClass("canceling"),c.removeClass("busy"))},onClick:function(a){if("decisionStages"!=this.type&&"dangerZones"!=this.type&&"actionRegisters"!=this.type){var b=jQuery(a.target),c=b.parents(".round-corners"),d=c.children(".component-body"),e=c.children(".component-footer-wrapper");if("none"==d.css("display")){if(setCookie(this.type),e.css("display","block"),d.css("display","block"),"commonalities"==this.type||"decisionHistory"==this.type){var f;"commonalities"==this.type?f="decisionHistory":"decisionHistory"==this.type&&(f="commonalities");var g,h=jQuery("."+f).find(".component-body");g="none"==h.css("display")?"."+this.type:".small-component-group-2",matchHeights(g)}}else if(deleteCookie(this.type),e.css("display","none"),d.css("display","none"),"commonalities"==this.type||"decisionHistory"==this.type){jQuery("."+this.type).css("height","43px");var f;"commonalities"==this.type?f="decisionHistory":"decisionHistory"==this.type&&(f="commonalities");var h=jQuery("."+f).find(".component-body");"none"!=h.css("display")&&matchHeights("."+f)}}},clearButton:function(a){a.preventDefault();var b=this;b.$el.find(".new").removeClass("edit"),b.$el.find(".new-button").removeClass("disabled"),b.$el.find(".new table .item").val(""),b.$el.find("input.clearItem").val(""),b.$el.find(".new .item").trigger("liszt:updated"),b.$el.find(".new .error").removeClass("error"),b.$el.find(".new .error-message").html(""),b.$el.find(".cancel-button").click()},deleteButton:function(a){if(a.preventDefault(),validateAccess(a)){var b=this,c=jQuery(a.target);compButton=c.parents(".component-button"),buttons=compButton.find(".buttons"),busy=compButton.find(".busy");var d=jQuery(c.attr("href"));c.hasClass("deleting")||(c.addClass("deleting"),compButton.addClass("busy"),confirm("Are you sure you want to delete this item?")?Visualforce.remoting.Manager.invokeAction(controller+".deleteObj",this.type,c.attr("href").replace("#"+this.type+"-",""),function(e){if(null==e)return void(window.location.href="/"+parentId);if("SUCCESS"==e)b.collection.getByParentId(parentId,function(){b.deleteButtonCallback(a)});else{var f=e.indexOf(":");if(0>f)return;var g=[];if(g[0]=e.substring(0,f),g[1]=e.substring(f+1),"ERROR"==g[0]){if(c.removeClass("deleting"),compButton.removeClass("busy"),f=g[1].indexOf("|"),0>f)return;var h=[];h[0]=g[1].substring(0,f),h[1]=g[1].substring(f+1);var i=d.find("."+h[0].charAt(0).toUpperCase()+h[0].slice(1));i.find(".error-message").show(),i.find(".error-message").html(h[1])}}}):(c.removeClass("deleting"),compButton.removeClass("busy")))}},deleteButtonCallback:function(){var a=this;a.$el.find(".refresh-button").click()},editButton:function(a){a.preventDefault();var b=jQuery(a.target),c=jQuery(b.attr("href"));if(/(msie|ie)/.test(navigator.userAgent.toLowerCase())&&b.parents(".component").hasClass("evaluators")){var d=b.attr("href").replace("#"+this.type+"-",""),e=$("#evaluators-"+d+" .edit .alternativeSelectPick"),f=e.attr("current");null!=f&&(e.val(f),e.change(),e.trigger("liszt:updated"))}b.hasClass("editing")||(b.addClass("editing"),c.siblings(".edit").find(".cancel-button").click(),c.siblings(".edit").find(".clear-button").click(),c.addClass("edit"),c.find('input[type="text"]:first').focus(),b.removeClass("editing"))},newButton:function(a){if(!$(a.target).parents(".component").hasClass("evaluators")&&0!=$(a.target).parents(".component").find(".error_message").length)return void $(a.target).parents(".component").find(".modal.error_message").modal().modal("show");a.preventDefault();var b=this,c=b.$el.find(".new"),d=b.$el.find(".new-button");d.hasClass("disabled")||(b.$el.find(".cancel-button").click(),b.$el.find(".clear-button").click(),d.addClass("disabled"),c.addClass("edit"),$(a.target).parents(".component").hasClass("dangerZones")&&matchHeights(".small-component-group-1"),c.find('input[type="text"]:first').focus())},saveButton:function(a){if(a.preventDefault(),validateAccess(a)){var b=this,c=jQuery(a.target),d=c.parents(".component-button"),e=(d.find(".buttons"),d.find(".busy"),""),f="",g="",h=jQuery(c.attr("href")),i=0;if(!c.hasClass("saving")){c.addClass("saving"),d.addClass("busy"),h.find(".component-body-item-field").removeClass("error"),h.find(".error-message-extra").hide(),h.find(".error-message").html("");var j=!1,k=h.find(".required-set");k.length>0&&(k.each(function(){var a=jQuery(this).val();(null==a||"null"==a)&&(a=""),""!=a&&(j=!0)}),j||(++i,h.find(".SaveObj").addClass("error"),h.find(".SaveObj .error-message").html("At least one field must be populated.")));var l=!1,m=0;h.find(".required-one-of-two").each(function(){m+=1;var a=jQuery(this),b=a.closest(".component-body-item-field"),c=a.val()?jQuery.trim(""+a.val()):"";""!=c&&(l=!0),2!=m||l||(b.addClass("error"),b.find(".error-message").html("Required to populate value for one of two fields."),++i)}),h.find(".required").each(function(){var a=jQuery(this),b=a.closest(".component-body-item-field"),c=a.val()?jQuery.trim(""+a.val()):"";!a.hasClass("noLimit")&&c.length>255?(b.addClass("error"),b.find(".error-message").html("Max length 255. Currently "+c.length+"."),++i):""==c&&(b.addClass("error"),b.find(".error-message").html("Required"),++i)}),h.find(".key").each(function(){var a=jQuery(this),b=a.closest(".component-body-item-field"),c=encodeURIComponent(a.attr("name")),d=a.val()?jQuery.trim(""+a.val()):"";!a.hasClass("noLimit")&&d.length>255?(b.addClass("error"),b.find(".error-message").html("Max length 255. Currently "+d.length+"."),++i):""==d?(b.addClass("error"),b.find(".error-message").html("Required"),++i):f+=c+"="+encodeURIComponent(d)+"&"}),h.find(".keyId").each(function(){var a=jQuery(this);g=encodeURIComponent(a.val())});var n=!1;if(c.parents(".component").hasClass("evaluators")){var o=c.attr("href").replace("#"+this.type+"-","");null!=o&&""!=o&&2==totalAmountOfEvaluators&&(canCreateCCEvaluator=!0)}if(h.find(".item").each(function(){var b=jQuery(this),c=b.closest(".component-body-item-field"),d=encodeURIComponent(b.attr("name")),f=b.val()?jQuery.trim(""+b.val()):"";$(a.target).parents(".component").hasClass("decisionHistory")&&"Outcome_Alternative__c"==d&&(vals=f.split(","),f="",_.each(vals,function(a){null!=a&&""!=a&&(f+=a+",")}),""!=f&&(f=f.substring(0,f.length-1))),$(a.target).parents(".component").hasClass("evaluators")&&"AXIOM_BASE__Roles__c"==d&&-1!=f.indexOf("CC")&&(n=!0),!b.hasClass("noLimit")&&f.length>255?(c.addClass("error"),c.find(".error-message").html("Max length 255. Currently "+f.length+"."),++i):"null"==f&&(f=""),"SELECT"==b.get(0).tagName.toUpperCase()&&b.get(0).getAttribute("multiple")&&(f=f.replace(/,/g,";")),b.hasClass("date")&&(f=$.datepicker.formatDate("yy-mm-dd",new Date(f))),e+=d+"="+encodeURIComponent(f)+"&"}),n&&!canCreateCCEvaluator&&0!=$(a.target).parents(".component").find(".error_message").length){$(a.target).parents(".component").find(".modal.error_message").modal().modal("show"),c.removeClass("saving"),d.removeClass("busy");var o=c.attr("href").replace("#"+this.type+"-","");return void(null!=o&&""!=o&&2==totalAmountOfEvaluators&&(canCreateCCEvaluator=!0))}if(c.parents(".component").hasClass("evaluators")){var o=c.attr("href").replace("#"+this.type+"-","");null!=o&&""!=o&&2==totalAmountOfEvaluators&&(canCreateCCEvaluator=!0)}if(i>0)return c.removeClass("saving"),void d.removeClass("busy");var p=h.attr("id");p=p.substring(0,p.indexOf("-")),Visualforce.remoting.Manager.invokeAction(controller+".saveObj",p,g,f,e,function(a){if(null==a)return void(window.location.href="/"+parentId);var e=a.split(":",2);if("ID"==e[0])b.saveButtonCallback(g);else if("ERROR"==e[0]){c.removeClass("saving"),d.removeClass("busy");var f=e[1].split("|",2),i="";if(f[0].indexOf("axiom_base__")>=0&&(i="AXIOM_BASE__",f[0]=f[0].replace("axiom_base__","")),2==f.length){var j=h.find("."+i+f[0].charAt(0).toUpperCase()+f[0].slice(1));j.addClass("error"),"."!=f[1].charAt(f[1].length-1)&&(f[1]+="."),"Duplicate key."==f[1]?(h.find(".key").parents(".component-body-item-field").addClass("error"),j.find(".error-message").html(b.duplicateErrorMsg)):(j.find(".error-message-extra").show(),j.find(".error-message").html(f[1]))}}})}}},saveButtonCallback:function(){var a=this;a.$el.find(".refresh-button").click()},clickSaveButton:function(a){var b=jQuery(a.target),c=b.parents(".component-body-item").find(".save-button");return b.hasClass("noEnterSave")?void(13==a.keyCode&&a.preventDefault()):void(13==a.keyCode&&(a.preventDefault(),c.click()))},refreshButton:function(a){a.preventDefault();{var b=this,c=jQuery(a.target),d=c.parents(".component-button");d.find(".buttons"),d.find(".busy")}c.hasClass("refreshing")||(c.addClass("refreshing"),d.addClass("busy"),b.collection.getByParentId(parentId,function(){b.$el.find("clear-button").click(),_.each(b.dependentComponents,function(a){jQuery("."+a).trigger("refreshDepend")}),b.renderContent(),c.removeClass("refreshing"),d.removeClass("busy")}))},refreshDepend:function(a){a.preventDefault();var b=this;$(a.target).hasClass("refreshing")||($(a.target).addClass("refreshing"),b.collection.getByParentId(parentId,function(){b.$el.find("clear-button").click(),b.renderContent(),$(a.target).removeClass("refreshing")}))},setStatus:function(a,b){var c=jQuery(a.target).siblings(".item"),d=c.parents(".AXIOM_BASE__Status__c"),e=c.val();d.removeClass(e),e==b?(d.addClass("none"),c.val("none")):(d.addClass(b),c.val(b))},setMinus:function(a){a.preventDefault();var b=this,c=jQuery(a.target),d=c.parents(".component-button"),e=(d.find(".buttons"),d.find(".busy"),jQuery(c.attr("href")).find(".save-button"));e.hasClass("saving")||(b.setStatus(a,"minus"),e.click())},setPlus:function(a){a.preventDefault();var b=this,c=jQuery(a.target),d=c.parents(".component-button"),e=(d.find(".buttons"),d.find(".busy"),jQuery(c.attr("href")).find(".save-button"));e.hasClass("saving")||(b.setStatus(a,"plus"),e.click())}});loadActionRegisters=function(a){var b="actionRegisters",c=jQuery("."+b),d=new componentDataCollection;d.getByParentIdAndType(parentId,b,function(){var e=new componentView({collection:d,el:c}),f=encodeURIComponent("/"+parentId),g="/00T/e?title=Call&followup=1&tsk5=Call&what_id="+parentId+"&who_id="+parentAccountId+"&retURL="+f+"&saveURL="+f,h="/00T/e?what_id="+parentId+"&who_id="+parentAccountId+"&retURL="+f+"&saveURL="+f,i="/00U/e?what_id="+parentId+"&who_id="+parentAccountId+"&retURL="+f+"&saveURL="+f;e.render({title:"Activities",type:b,dependentComponents:["dangerZones","decisionStages"],buttons:[{name:"New Action",buttonClass:"add-action-register button",dropdown:!0,options:[{name:"Log a Call",buttonClass:"logButton",href:g},{name:"New Task",buttonClass:"taskButton",href:h},{name:"New Event",buttonClass:"eventButton",href:i}]},{name:"",buttonClass:"help-button button",href:urlsMap[b.toLowerCase()],target:"_blank"}],events:{"click .edit-button":function(){},"change .save-modal":function(a){var b=jQuery(a.target),c=jQuery(b.attr("href"));b.attr("checked")&&"true"==b.attr("current")&&c.length?c.modal("show"):b.siblings(".save-button").click()},"click .modal-save-button":function(a){a.preventDefault();var b=jQuery(a.target),c=b.parents(".modal"),d="";c.find("input:checked").each(function(){var a=jQuery(this);d+=a.val()+","}),-1!=d.indexOf(",")&&(d=d.substring(0,d.length-1)),c.find('.item[name="AXIOMOMD__Danger_Zones__c"]').val(d),Visualforce.remoting.Manager.invokeAction(controller+".updateObjs","dangerZones",d,"Addressed__c=true",function(a){return null==a?void window.location.reload(!0):(c.find(".save-button").click(),void c.modal("hide"))
})},"click .modal-cancel-button":function(a){a.preventDefault();var b=jQuery(a.target),c=b.parents(".modal");jQuery(b.attr("href")).find(":checked").removeAttr("checked",""),jQuery(b.attr("href")).find(".switch-on").removeClass("switch-on").addClass("switch-off"),c.modal("hide")},"click .Priority.Priority-High":function(a){var b=jQuery(a.target);b.removeClass("Priority-High"),b.addClass("Priority-Normal")},"click .Priority.Priority-Normal":function(a){var b=jQuery(a.target);b.removeClass("Priority-Normal"),b.addClass("Priority-High")},"click .hide-actionRegisters":function(a){a.preventDefault(),c.find(".grayOut").hide(),c.find(".hide-actionRegisters").hide(),c.find(".show-actionRegisters").show(),matchHeights(".small-component-group-1")},"click .show-actionRegisters":function(a){a.preventDefault(),c.find(".grayOut").show(),c.find(".show-actionRegisters").hide(),c.find(".hide-actionRegisters").show(),matchHeights(".small-component-group-1")}}},function(){$(".closer").bootstrapSwitch(),getSecFromCookies(done);var b=c.find(".grayOut");b.each(function(){var a=jQuery(this),b=c.find(".toggle-actionRegisters");a.insertAfter(b)}),c.find(".dropdown-toggle").dropdown(),c.find(".dropdown-toggle.hidden").hide(),c.find(".modal").modal().modal("hide"),c.find(".dropdown-toggle").click(function(a){a.preventDefault();var b=jQuery(a.target),d=b.parents(".dropdown");c.find(".dropdown").removeClass("open"),d.addClass("open")}),editDOM(function(){matchHeights(".small-component-group-1")}),"function"==typeof a&&a()})})},loadBusinessStates=function(a){var b="businessStates",c=jQuery("."+b),d=new componentDataCollection;d.getByParentIdAndType(parentId,b,function(){var e=new componentView({collection:d,el:c}),f=function(){var a=[];return _.each(evList,function(b){var c=b.AXIOM_BASE__Contact__r.Name,d=b.Id;a.push({Id:d,Name:c})}),a};e.render({title:"Business State & Gaps",type:b,options:{biow:f,bsAreas:bsAreas,bsImpacts:bsImpacts,modalOptions:modalOptions[b]},newItem:{hasAccountPlan:{number:"0"},items:[{itemName:prentFieldAPI,itemValue:parentId,itemType:"item"},{itemName:"AXIOM_BASE__Account__c",itemValue:parentAccountId,itemType:"item"}]},dependentComponents:["evaluators","dangerZones"],buttons:[{name:"",buttonClass:"help-button button",href:urlsMap[b.toLowerCase()],target:"_blank"}],events:{"click .ap-button":function(a){if(a.preventDefault(),!$(".businessStates .ap-button").hasClass("disabled")){$("#ap-bs-Modal").modal("show")}}},duplicateErrorMsg:"The selected Evaluator already has an entry with this Description pick-list value, duplicates for the same Evaluator are not allowed."},function(){c.find(".AXIOM_BASE__Impact__c .view").each(function(){jQuery(this).html(jQuery(this).html().replace(/;/g,", "))});c.find(".component-body-item");_.each(d.models,function(a){c.find(".toggle-"+a.get("AXIOM_BASE__BIO_Worksheet__c")+" .AXIOM_BASE__BIO_Worksheet__c span:first").show()}),_.each(evList.models,function(a){a.hidden?c.find(".toggle-"+a.get("Id")).addClass("hidden no-pdf"):c.find(".toggle-"+a.get("Id")).removeClass("hidden no-pdf")}),$("#ap-bs-Modal").modal().modal("hide"),loadModalBusinessStates(function(){}),"function"==typeof a&&a(d)})})},loadCommonalities=function(a){var b="commonalities",c=jQuery("."+b),d=new componentDataCollection;d.getByParentIdAndType(parentId,b,function(){var e=new componentView({collection:d,el:c});e.render({title:"Commonalities",type:b,options:{modalTitle:"Pull From Existing Commonalities",modalOptions:modalOptions[b]},status:{"class":"Commonality_Status",value:commonalityStatus},newItem:{items:[{itemName:prentFieldAPI,itemValue:parentId,itemType:"item"},{itemName:"AXIOM_BASE__Account__c",itemValue:parentAccountId,itemType:"item"}],hasAccountPlan:{number:"0"}},dependentComponents:[],buttons:[{name:"",buttonClass:"help-button button",href:urlsMap[b.toLowerCase()],target:"_blank"}],events:{"click .ap-button":function(a){a.preventDefault(),$("#ap-commonalities-Modal").modal("show")},"click .new-button":function(a){var b=this;b.newButton(a),matchHeights(".small-component-group-2")},"click .clear-button":function(a){var b=this;b.clearButton(a),matchHeights(".small-component-group-2")},"click .edit-button":function(a){var b=this;b.editButton(a),matchHeights(".small-component-group-2")},"click .cancel-button":function(a){var b=this;b.cancelButton(a),matchHeights(".small-component-group-2")},"click .Commonality_Status .minus":function(){commonalityStatus="minus",jQuery(".component-header .Commonality_Status").hasClass("minus")&&(commonalityStatus="none"),Visualforce.remoting.Manager.invokeAction(controller+".changeCommonalityStatus",parentId,commonalityStatus,function(a){if("SUCCESS"==a)jQuery(".component-header .Commonality_Status").removeClass().addClass("Commonality_Status left "+commonalityStatus),renderWinData();else{var b=a.split(":",2);if("ERROR"==b[0]){var c=b[1].split("|",2);addError(c)}}})},"click .Commonality_Status .plus":function(){commonalityStatus="plus",jQuery(".component-header .Commonality_Status").hasClass("plus")&&(commonalityStatus="none"),Visualforce.remoting.Manager.invokeAction(controller+".changeCommonalityStatus",parentId,commonalityStatus,function(a){if("SUCCESS"==a)jQuery(".component-header .Commonality_Status").removeClass().addClass("Commonality_Status left "+commonalityStatus),renderWinData();else{var b=a.split(":",2);if("ERROR"==b[0]){var c=b[1].split("|",2);addError(c)}}})}}},function(){"empty"==commonalityStatus?(changeWinData("commonalities"),$(".Commonality_Status").hide()):$(".Commonality_Status").show(),1==e.collection.length&&changeWinData("commonalities"),"plus"==commonalityStatus?$(".Commonality_Status").removeClass().addClass("Commonality_Status left plus"):"minus"==commonalityStatus?$(".Commonality_Status").removeClass().addClass("Commonality_Status left minus"):(commonalityStatus="none")&&$(".Commonality_Status").removeClass().addClass("Commonality_Status left none"),$(".modal-backdrop").remove(),matchHeights(".small-component-group-2"),$("#ap-commonalities-Modal").modal().modal("hide");var b=c.find("textarea");b.keyup(function(){matchHeights(".small-component-group-2")}),loadModalCommonalities(function(){}),"function"==typeof a&&a(d)})})},loadCurrentPSCF=function(a){var b="currentPSCF",c=jQuery("."+b),d=new componentDataCollection;d.getByParentIdAndType(parentId,b,function(){var e=new componentView({collection:d,el:c});e.render({title:"Current P/S/C/F",type:b,options:{modalTitle:"Pull From Existing Current P/S/C/F",modalOptions:modalOptions[b]},newItem:{items:[{itemName:prentFieldAPI,itemValue:parentId,itemType:"item"},{itemName:"AXIOM_BASE__Account__c",itemValue:parentAccountId,itemType:"item"}],hasAccountPlan:{number:"0"}},dependentComponents:[],buttons:[{name:"",buttonClass:"help-button button",href:urlsMap[b.toLowerCase()],target:"_blank"}],events:{"click .ap-button":function(a){if(a.preventDefault(),!$(".currentPSCF .ap-button").hasClass("disabled")){$("#ap-currentPSCF-Modal").modal("show")}},"click .edit-button":function(a){a.preventDefault();var b=jQuery(a.target),c=jQuery(b.attr("href"));if(/(msie|ie)/.test(navigator.userAgent.toLowerCase())&&b.parents(".component").hasClass("evaluators")){var d=b.attr("href").replace("#"+this.type+"-",""),e=$("#evaluators-"+d+" .edit .alternativeSelectPick"),f=e.attr("current");null!=f&&(e.val(f),e.change(),e.trigger("liszt:updated"))}b.hasClass("editing")||(b.addClass("editing"),c.siblings(".edit").find(".cancel-button").click(),c.siblings(".edit").find(".clear-button").click(),c.addClass("edit"),c.find('input[type="text"]:first').focus(),b.removeClass("editing"))}}},function(){$(".modal-backdrop").remove(),$("#ap-currentPSCF-Modal").modal().modal("hide"),loadModalCurrentPSCF(function(){}),"function"==typeof a&&a(d)})})},loadDangerZones=function(a){function b(a,b,c){Visualforce.remoting.Manager.invokeAction(controller+".updateObjs","dangerZones",a,b,function(a){""==a&&(g.find(".edit-danger-zones").hide(),c())})}function c(){var a="";return g.find(".assignToAction input:checked").each(function(){var b=jQuery(this);a+=b.val()+","}),a&&(a=a.substring(0,a.length-1)),a}function d(){var a="";return g.find(".grayOut .assignToAction input:checked").each(function(){var b=jQuery(this);a+=b.val()+","}),a&&(a=a.substring(0,a.length-1)),a}function e(){var a="";return g.find(".noGrayOut .assignToAction input:checked").each(function(){var b=jQuery(this);a+=b.val()+","}),a&&(a=a.substring(0,a.length-1)),a}var f="dangerZones",g=jQuery("."+f),h=new componentDataCollection,i="&saveURL="+encodeURIComponent("/"+parentId)+"&retURL="+encodeURIComponent("/"+parentId);h.getByParentIdAndType(parentId,f,function(){var j=new componentView({collection:h,el:g}),k=function(){var a=[];return _.each(evList,function(b){var c=b.AXIOM_BASE__Contact__r.Name,d=b.Id;a.push({Id:d,Name:c})}),a};j.render({title:"Danger Zones",type:f,options:{biow:k},newItem:{items:[{itemName:prentFieldAPI_OMD,itemValue:parentId,itemType:"item"},{itemName:"isCustom__c",itemValue:"true",itemType:"item"}]},dependentComponents:["actionRegisters"],buttons:[{name:"Edit",buttonClass:"edit-danger-zones button hidden",dropdown:!0,options:[{name:"Mark as Addressed",buttonClass:"dzAddress"},{name:"Mark as Unaddressed",buttonClass:"dzUnaddress"},{isDivider:!0},{name:"Log a Call",buttonClass:"dzCall"},{name:"Create a Task",buttonClass:"dzTask"},{name:"Schedule an Event",buttonClass:"dzEvent"},{isDivider:!0},{name:"Remove Action",buttonClass:"dzRemoveAction"}]},{name:"",buttonClass:"help-button button",href:urlsMap[f.toLowerCase()],target:"_blank"}],events:{"click .assignToAction input:checkbox":function(){var a=g.find(".assignToAction input:checked").length,b=g.find(".edit-danger-zones");a>0?(b.find(".button-name").html("Edit "+a),b.show()):b.hide()},"click .dzAddress":function(a){a.preventDefault(),b(e(),"Addressed__c=true",function(){jQuery(".dangerZones .refresh-button").click()})},"click .dzUnaddress":function(a){a.preventDefault(),b(d(),"Addressed__c=false",function(){jQuery(".dangerZones .refresh-button").click()})},"click .dzCall":function(a){a.preventDefault();var b=c();Visualforce.remoting.Manager.invokeAction(controller+".saveRelatedAction",b,"Call",parentId,function(a){location.href="/"+a+"/e?"+i},{escape:!1})},"click .dzTask":function(a){a.preventDefault();var b=c();Visualforce.remoting.Manager.invokeAction(controller+".saveRelatedAction",b,"Task",parentId,function(a){location.href="/"+a+"/e?"+i},{escape:!1})},"click .dzEvent":function(a){a.preventDefault();var b=c();Visualforce.remoting.Manager.invokeAction(controller+".saveRelatedAction",b,"Event",parentId,function(a){location.href="/"+a+"/e?"+i},{escape:!1})},"click .dzRemoveAction":function(a){a.preventDefault();var b=c();Visualforce.remoting.Manager.invokeAction(controller+".removeActionAssignment",b,function(a){return null==a?void(window.location.href="/"+parentId):void jQuery(".dangerZones .refresh-button").click()})},"click .hide-dangerZones":function(a){a.preventDefault(),g.find(".grayOut").hide(),g.find(".hide-dangerZones").hide(),g.find(".show-dangerZones").show(),matchHeights(".small-component-group-1")},"click .show-dangerZones":function(a){a.preventDefault(),g.find(".grayOut").show(),g.find(".show-dangerZones").hide(),g.find(".hide-dangerZones").show(),matchHeights(".small-component-group-1")}}},function(){var b=g.find(".edit-danger-zones");b.hide();var c=g.find(".grayOut");c.each(function(){var a=jQuery(this),b=g.find("#dangerZones-");a.insertBefore(b)});var d=(g.find(".component-body-item"),g.find("textarea"));d.keyup(function(){matchHeights(".small-component-group-1")}),editDOM(function(){matchHeights(".small-component-group-1")}),"function"==typeof a&&a(h)})})},loadDecisionHistory=function(a){function b(a){var b=a.val(),d=a.closest(".alternative-field").find(".alternativeSelect");if(b.indexOf(",")>-1&&(b=b.substring(0,b.indexOf(","))),b=b.replace(/<\/?script>/g,"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),b.trim(),b.length){var e=d.siblings(".chzn-container").find(".chzn-drop .chzn-results");if(d.find('option[value="'+b+'"]').length)a.val("");else{d.append('<option value="'+b+'" class="custom">'+b+"</option>").trigger("liszt:updated");var f=jQuery.Event("mouseup");f.target=e.find("li:last").addClass("highlighted"),e.trigger(f),c(".alternative-field")}}else a.val("")}function c(a){jQuery(a+" .search-choice-close").each(function(){jQuery(this).click(function(b){jQuery(b.target);jQuery(a+" select").trigger("liszt:updated"),c(".alternative-field")})})}var d="decisionHistory",e=jQuery("."+d),f=new componentDataCollection;f.getByParentIdAndType(parentId,d,function(){var g=new componentView({collection:f,el:e}),h=function(){var a=[],b="";return _.each(f.models,function(a){var c=a.get("BIO_Worksheet__c");b+=c+";"}),_.each(evList,function(c){var d=c.AXIOM_BASE__Contact__r.Name,e=c.Id;-1==b.indexOf(e)&&a.push({Id:e,Name:d})}),a},i=function(){var a=[];return _.each(alternatives,function(b){a.push(b.label)}),[].concat(a,customAlternatives())},j=function(){var a=[];return _.each(g.collection.models,function(b){var c=b.get("Prior_Alternatives__c");c&&_.each(c.split(";"),function(b){a.push(b)})}),a=_.uniq(a),a=_.difference(a,i())};g.render({title:"Decision History",type:d,options:{biow:h,alternatives:i,customAlternatives:j},newItem:{},dependentComponents:[],buttons:[{name:"",buttonClass:"help-button button",href:urlsMap[d.toLowerCase()],target:"_blank"}],events:{"click .new-button":function(a){var b=this;b.newButton(a),matchHeights(".small-component-group-2")},"click .clear-button":function(a){var b=this;b.clearButton(a),matchHeights(".small-component-group-2")},"click .edit-button":function(a){var b=this;b.editButton(a),matchHeights(".small-component-group-2")},"click .cancel-button":function(a){var b=this;b.cancelButton(a),matchHeights(".small-component-group-2")},"keyup .decisionHistory .alternative-field .search-field input":function(a){var d=jQuery(a.target),e=d.closest(".alternative-field").find(".alternativeSelect");if((13==a.keyCode||188==a.keyCode)&&b(d),8==a.keyCode){var f=e.find(".custom.deleteMe");f.length&&(f.remove(),e.trigger("liszt:updated"),c(".alternative-field"));var g=d.parents(".search-field").siblings(".search-choice-focus");g.length&&e.find('.custom[value="'+g.text()+'"]').addClass("deleteMe")}else e.find(".custom.deleteMe").removeClass("deleteMe")},"blur .decisionHistory .alternative-field .search-field input":function(a){var c=jQuery(a.target),d=c.closest(".alternative-field").find(".alternativeSelect");d.find(".custom.deleteMe").removeClass("deleteMe"),b(c)}}},function(){e.find(".Prior_Alternatives__c .view").each(function(){jQuery(this).html(jQuery(this).html().replace(/;/g,", "))}),matchHeights(".small-component-group-2");{var b=e.find(".alternativeSelect");e.find(".alternativeSelectPick")}b.change(function(){var a=jQuery(this),b=a.val(),c='<option></option><option value="'+orgName+'">'+orgName+"</option>";b&&_.each(b,function(a){c+='<option value="'+a+'">'+a+"</option>"});var d=a.siblings(".picked-alternative").find(".alternativeSelectPick");pickAlternativeVal=d.val(),d.html(c),d.attr("current")&&d.val(d.attr("current")),d.val(pickAlternativeVal),d.trigger("liszt:updated"),matchHeights(".small-component-group-2")}),b.change();var c=e.find("textarea");if(c.keyup(function(){matchHeights(".small-component-group-2")}),noFancies){var d=e.find(".custom-alternatives");d.bind("keyup",function(a){var b=jQuery(this),c=b.parents(".component-body-item-field").find(".alternativeSelect");if(!a.shiftKey&&(13==a.keyCode||188==a.keyCode)){var d=jQuery(a.target).val();if(d.indexOf(",")>-1&&(d=d.substring(0,d.indexOf(","))),d=d.replace(/<\/?script>/g,"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),d.trim(),d.length&&0==c.find('option[value="'+d+'"]').length){var e=c.val();null==e&&(e=[]),c.append('<option value="'+d+'" class="custom">'+d+"</option>"),e.push(d),c.val(e),c.change()}jQuery(a.target).val("")}}),d.bind("blur",function(){var a=jQuery(this);""==a.val()&&(a.val(a.attr("dataHolder")),a.addClass("dataHolder"))}),d.bind("focus",function(){var a=jQuery(this);a.hasClass("dataHolder")&&(a.val(""),a.removeClass("dataHolder"))})}"function"==typeof a&&a(f)})})},loadDecisionStages=function(a){function b(){var a="";return d.find(".assignToAction input:checked").each(function(){var b=jQuery(this);a+=b.val()+","}),a&&(a=a.substring(0,a.length-1)),a}var c="decisionStages",d=jQuery("."+c),e=new componentDataCollection,f="&saveURL="+encodeURIComponent("/"+parentId)+"&retURL="+encodeURIComponent("/"+parentId);e.getByParentIdAndType(parentId,c,function(){var g=new componentView({collection:e,el:d});g.deleteButton=function(a){if(a.preventDefault(),validateAccess(a)){var b=this,c=jQuery(a.target);compButton=c.parents(".component-button"),buttons=compButton.find(".buttons"),busy=compButton.find(".busy");var d=jQuery(c.attr("href"));c.hasClass("deleting")||(c.addClass("deleting"),compButton.addClass("busy"),confirm("Are you sure you want to delete this item?")?Visualforce.remoting.Manager.invokeAction(controller+".deleteObj",this.type,c.attr("href").replace("#"+this.type+"-",""),function(e){if(null==e)return void(window.location.href="/"+parentId);if("SUCCESS"==e)Visualforce.remoting.Manager.invokeAction(controller+".removeActionAssignment",c.attr("href").replace("#"+this.type+"-",""),function(c){return""!=c?void(window.location.href="/"+parentId):void b.collection.getByParentId(parentId,function(){b.deleteButtonCallback(a)})});else{var f=e.split(":",2);if("ERROR"==f[0]){c.removeClass("deleting"),compButton.removeClass("busy");var g=f[1].split("|",2),h=d.find("."+g[0].charAt(0).toUpperCase()+g[0].slice(1));h.find(".error-message").show(),h.find(".error-message").html(g[1])}}}):(c.removeClass("deleting"),compButton.removeClass("busy")))}},g.render({title:"Decision Stages",type:c,newItem:{items:[{itemName:prentFieldAPI_OMD,itemValue:parentId,itemType:"item"}]},dependentComponents:["dangerZones","actionRegisters"],options:{parentId:parentId,ObjectType:ObjectType},status:{"class":"Decision_Status",value:decisionStatus},buttons:[{name:"Edit",buttonClass:"edit-danger-zones button hidden",dropdown:!0,options:[{name:"Log a Call",buttonClass:"dsCall"},{name:"Create a Task",buttonClass:"dsTask"},{name:"Schedule an Event",buttonClass:"dsEvent"},{isDivider:!0},{name:"Remove Action",buttonClass:"dsRemoveAction"}]},{name:"",buttonClass:"help-button button",href:urlsMap[c.toLowerCase()],target:"_blank"}],events:{"click .assignToAction input:checkbox":function(){var a=d.find(".assignToAction input:checked").length,b=d.find(".edit-danger-zones");a>0?(b.find(".button-name").html("Edit "+a),b.show()):b.hide()},"click .dsCall":function(a){a.preventDefault();var c=b();Visualforce.remoting.Manager.invokeAction(controller+".saveRelatedAction",c,"Call",parentId,function(a){location.href="/"+a+"/e?"+f},{escape:!1})},"click .dsTask":function(a){a.preventDefault();var c=b();Visualforce.remoting.Manager.invokeAction(controller+".saveRelatedAction",c,"Task",parentId,function(a){location.href="/"+a+"/e?"+f},{escape:!1})},"click .dsEvent":function(a){a.preventDefault();var c=b();Visualforce.remoting.Manager.invokeAction(controller+".saveRelatedAction",c,"Event",parentId,function(a){location.href="/"+a+"/e?"+f},{escape:!1})},"click .dsRemoveAction":function(a){a.preventDefault();var c=b();Visualforce.remoting.Manager.invokeAction(controller+".removeActionAssignment",c,function(a){return null==a?void(window.location.href="/"+parentId):void jQuery(".decisionStages .refresh-button").click()})},"click .new-button":function(a){var b=this;b.newButton(a),matchHeights(".small-component-group-1")},"click .clear-button":function(a){var b=this;b.clearButton(a),matchHeights(".small-component-group-1")},"click .edit-button":function(a){var b=this;b.editButton(a),matchHeights(".small-component-group-1")},"click .cancel-button":function(a){var b=this;b.cancelButton(a),matchHeights(".small-component-group-1")},"click .Decision_Status .minus":function(){decisionStatus="minus",jQuery(".component-header .Decision_Status").hasClass("minus")&&(decisionStatus="none"),Visualforce.remoting.Manager.invokeAction(controller+".changeDecisionStatus",parentId,decisionStatus,function(a){if("SUCCESS"==a)jQuery(".component-header .Decision_Status").removeClass().addClass("Decision_Status left "+decisionStatus),renderWinData();else{var b=a.split(":",2);if("ERROR"==b[0]){var c=b[1].split("|",2);addError(c)}}})},"click .Decision_Status .plus":function(){decisionStatus="plus",jQuery(".component-header .Decision_Status").hasClass("plus")&&(decisionStatus="none"),Visualforce.remoting.Manager.invokeAction(controller+".changeDecisionStatus",parentId,decisionStatus,function(a){if("SUCCESS"==a)jQuery(".component-header .Decision_Status").removeClass().addClass("Decision_Status left "+decisionStatus),renderWinData();else{var b=a.split(":",2);if("ERROR"==b[0]){var c=b[1].split("|",2);addError(c)}}})}}},function(){var b=d.find(".edit-danger-zones");b.hide(),"empty"==decisionStatus?(changeWinData("decisionStages"),$(".Decision_Status").hide()):$(".Decision_Status").show(),1==g.collection.length&&changeWinData("decisionStages"),"plus"==decisionStatus?$(".Decision_Status").removeClass().addClass("Decision_Status left plus"):"minus"==decisionStatus?$(".Decision_Status").removeClass().addClass("Decision_Status left minus"):(decisionStatus="none")&&$(".Decision_Status").removeClass().addClass("Decision_Status left none"),$(".date").datepicker({dateFormat:"M dd, yy",showOn:"button",buttonImage:calendarURL,buttonImageOnly:!0}),editDOM(function(){matchHeights(".small-component-group-1")}),"function"==typeof a&&a(e)})})},loadEvaluators=function(a){function b(){var a=function(b){jQuery(b+" .search-choice-close").each(function(){jQuery(this).click(function(c){jQuery(c.target);jQuery(b+" select").trigger("liszt:updated"),a(".alternative-field")})})},b=function(b){if(isAlternativeObjEmpty){var c=b.val(),d=b.closest(".alternative-field").find(".alternativeSelect");if(c.indexOf(",")>-1&&(c=c.substring(0,c.indexOf(","))),c=c.replace(/<\/?script>/g,"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),c.trim(),c.length){var e=d.siblings(".chzn-container").find(".chzn-drop .chzn-results");if(d.find('option[value="'+c+'"]').length)b.val("");else{d.append('<option value="'+c+'" class="custom">'+c+"</option>").trigger("liszt:updated");var f=jQuery.Event("mouseup");f.target=e.find("li:last").addClass("highlighted"),e.trigger(f),a(".alternative-field")}}else b.val("")}};return{"keyup .evaluators .alternative-field .search-field input":function(c){var d=jQuery(c.target),e=d.closest(".alternative-field").find(".alternativeSelect");if((13==c.keyCode||188==c.keyCode)&&b(d),8==c.keyCode){var f=e.find(".custom.deleteMe");f.length&&(f.remove(),e.trigger("liszt:updated"),a(".alternative-field"));var g=d.parents(".search-field").siblings(".search-choice-focus");g.length&&e.find('.custom[value="'+g.text()+'"]').addClass("deleteMe")}else e.find(".custom.deleteMe").removeClass("deleteMe")},"blur .evaluators .alternative-field .search-field input":function(a){var c=jQuery(a.target),d=c.closest(".alternative-field").find(".alternativeSelect");d.find(".custom.deleteMe").removeClass("deleteMe"),b(c)}}}function c(a){return{"keyup .AXIOM_BASE__Contact__c .chzn-search input":function(b){if(null!=String.fromCharCode(b.keyCode)){var c=jQuery(b.target),d=c.val();options="";var e=a.$el.find(".AXIOM_BASE__Contact__c select");setTimeout(function(){if(d==c.val()){var a="<option></option>";Visualforce.remoting.Manager.invokeAction(controller+".getContactsByQ",d,parentId,function(f){if(null==f)return void(window.location.href="/"+parentId);if(d==c.val()){if(_.each(f,function(b){a+='<option value="'+b.Id+'">'+b.Name+" ("+(b.AccountId?b.Account.Name:"No Account")+")</option>"}),0==f.length){e.html("<option></option>").trigger("liszt:updated");var g='<li class="no-results active-results">No results found for "'+d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'". <a href="'+contactURL+'" onClick="window.location.href = this.href;">Add a new contact</a>?</li>';jQuery(b.target).closest(".chzn-search").siblings(".chzn-results").html(g)}else e.html(a).trigger("liszt:updated");c.val(d)}})}},500)}}}}var d="evaluators",e=jQuery("."+d),f=new componentDataCollection;f.getByParentIdAndType(parentId,d,function(){var g=new componentView({collection:f,el:e});g.refreshButton=function(a){a.preventDefault();var b=g,c=jQuery(a.target);c.hasClass("refreshing")||(c.addClass("refreshing"),b.collection.getByParentId(parentId,function(){b.$el.find("clear-button").click(),_.each(b.dependentComponents,function(a){jQuery("."+a+" .refresh-button").trigger("refreshDepend")}),Visualforce.remoting.Manager.invokeAction(controller+".getContactsByQ","",parentId,function(a){contacts=[],_.each(a,function(a){contacts.push({Id:a.Id,Name:a.Name+"("+(null==a.AccountId?"No Account":a.Account.Name)+")"})}),b.options.contacts=contacts,b.renderContent(),renderWinData(),c.removeClass("refreshing")})}))},g.refreshDepend=function(a){a.preventDefault();var b=g;b.collection.getByParentId(parentId,function(){b.$el.find("clear-button").click(),Visualforce.remoting.Manager.invokeAction(controller+".getContactsByQ","",parentId,function(a){contacts=[],_.each(a,function(a){contacts.push({Id:a.Id,Name:a.Name+"("+(null==a.AccountId?"No Account":a.Account.Name)+")"})}),b.options.contacts=contacts,b.renderContent(),renderWinData()})})},customAlternatives=function(){var a=[];return isAlternativeObjEmpty&&a.push("Do Nothing"),_.each(g.collection.models,function(b){var c=b.get("AXIOM_BASE__Alternatives__c");c&&_.each(c.split(";"),function(b){a.push(b)})}),a=_.uniq(a),a=_.difference(a,alternatives)},g.saveButtonCallback=function(a){var b=this;Visualforce.remoting.Manager.invokeAction(controller+".purgeEvaluatorDataById",a,function(){b.$el.find(".refresh-button").click()})};var h="/003/e?retURL="+encodeURIComponent("/"+parentId)+"&saveURL="+encodeURIComponent("/"+parentId)+"&con4_lkid="+encodeURIComponent(parentAccountId),i=function(){var a=[];return a.push({modal:"error_message",text:"Please enter at least 2 evaluators, before creating an evaluator with CC role"}),a};g.render({title:"Evaluators & Relationships",type:d,newItem:{items:[{itemName:prentFieldAPI,itemValue:parentId,itemType:"key"}]},options:{ObjectType:ObjectType,parentId:parentId,contacts:contacts,contactURL:h,roles:roles,roleSize:roles.length,alternatives:alternatives,customAlternatives:customAlternatives,influenceScores:influenceScores,goodQualityScores:goodQualityScores,rQualityScores:rQualityScores,hasLightbox:i},dependentComponents:["businessStates","dangerZones","financialCriteria","pscCriteria","decisionHistory","actionRegisters"],buttons:[{name:"",buttonClass:"help-button button",href:urlsMap[d.toLowerCase()],target:"_blank"}],events:jQuery.extend(b(),c(g),{"click .save-button-wrapper":function(a){a.preventDefault();var b=jQuery(a.target),c=jQuery(b.attr("href")),d=c.find(".AXIOM_BASE__Roles__c select"),e=d.attr("current").split(";"),f=d.val(),g=_.difference(e,f);null==f&&(f=[""]),(!(g.length>1||1==g.length&&""!=g[0])||confirm("Warning! Removing an Evaluator's Role will delete all criteria associated with that Role. Press OK to continue."))&&c.find(".save-button").click()},"click .modal-cancel-button":function(a){a.preventDefault();var b=jQuery(a.target),c=b.parents(".modal");c.modal("hide")},"change .Toggler input":function(a){var b=this,c=jQuery(a.target),d=c.val().replace(".toggle-",""),e=c.attr("checked");e?(c.parents(".component-body-item").removeClass("no-pdf"),jQuery(c.val()).removeClass("hidden no-pdf"),_.each(b.collection.models,function(a){a.get("Id")==d&&(a.hidden=!1)})):(c.parents(".component-body-item").addClass("no-pdf"),jQuery(c.val()).addClass("hidden no-pdf"),_.each(b.collection.models,function(a){a.get("Id")==d&&(a.hidden=!0)})),jQuery('select[name="AXIOM_BASE__BIO_Worksheet__c"]').each(function(){var a=jQuery(this),b=a.find('option[value="'+d+'"]'),c=jQuery("#"+a.attr("id")+"_chzn_o_"+b.index());a.val()==d&&(a.val(""),a.trigger("liszt:updated")),e?(b.show(),c.show()):(b.hide(),c.hide())})}})},function(){$("#eval-Modal").modal().modal("hide"),e.find(".AXIOM_BASE__Roles__c .view").each(function(){jQuery(this).html(jQuery(this).text().replace(/;/g,", "))}),e.find(".AXIOM_BASE__Alternatives__c .view .text").each(function(){jQuery(this).html(jQuery(this).text().replace(/;/g,", "))}),e.find(".AXIOM_BASE__Contact__c .accountName").each(function(){jQuery(this).attr("id")==accountId&&jQuery(this).attr("style","display:none;")});e.find(".component-body-item");e.find(".component-body").removeClass("hasDecisionMaker"),_.each(g.collection.models,function(a){var b=a.get("AXIOM_BASE__Contact__c"),c=a.get("AXIOM_BASE__Influence_Score__c");if(jQuery(".toggle-"+b).show(),6==c)e.find(".component-body").addClass("hasDecisionMaker");else if(e.find(".component-body").hasClass("hasDecisionMaker")){var f=jQuery("#"+d+"-"+a.get("Id")).find(".AXIOM_BASE__Influence__c select");f.find('option[value="'+influenceScores[0]+'"]').remove(),noFancies||f.trigger("liszt:updated")}});var b=(e.find(".AXIOM_BASE__Contact__c select"),e.find(".AXIOM_BASE__Roles__c select"));b.change(function(){var a=jQuery(this),b=a.parents(".roles-reports-wrapper").siblings(".AXIOM_BASE__Alternatives__c"),c=b.find(".picked-alternative select"),d=a.parents(".roles-reports-wrapper").siblings(".AXIOM_BASE__Influence__c"),e=(d.find("select"),a.parents(".roles-reports-wrapper").siblings(".AXIOM_BASE__Quality__c")),f=e.find(".normal select"),g=a.val();g&&-1!=_.indexOf(g,"CC",!0)?(c.val(orgName),c.attr("disabled",!0),f.find("option:gt(0)").attr("disabled",null),f.find("option:gt(2)").attr("disabled",!0),f.find('option[value="'+f.val()+'"]').attr("disabled")&&f.val(f.find("option:eq(2)").val())):(c.attr("disabled",null),c.val(""),f.find("option").attr("disabled",null)),c.trigger("liszt:updated"),f.trigger("liszt:updated")}),b.change();var c=e.find(".alternativeSelect"),h=e.find(".alternativeSelectPick");if(c.change(function(){var a=jQuery(this),b=a.val(),c='<option></option><option value="'+orgName+'">'+orgName+"</option>";b&&_.each(b,function(a){c+=isAlternativeObjEmpty?'<option value="'+a+'">'+a+"</option>":'<option value="'+alternativesMap[a]+'">'+alternativesMap[a]+"</option>"});var d=a.siblings(".picked-alternative").find(".alternativeSelectPick");pickAlternativeVal=d.val(),d.html(c),d.attr("current")&&d.val(d.attr("current")),d.val(pickAlternativeVal),d.trigger("liszt:updated")}),c.change(),h.change(function(){var a=jQuery(this),b=a.parents(".alternative-field").siblings(".AXIOM_BASE__Quality__c"),c=b.find(".normal select"),d=(b.find(".normal .chzn-results"),a.val());d==orgName?(c.find(":selected").hasClass("resister")&&c.val(""),c.find(".good").removeAttr("disabled"),c.find(".resister").attr("disabled","disabled")):(c.find(":selected").hasClass("good")&&c.val(""),c.find(".good").attr("disabled","disabled"),c.find(".resister").removeAttr("disabled")),c.trigger("liszt:updated")}),h.change(),noFancies){var i=e.find("#contact-input"),j=i.siblings('input[name="AXIOM_BASE__Contact__c"]');i.length&&(i.autocomplete({appendTo:"#contact-input-wrapper",close:function(){""==j.val()&&i.val(""),i.removeClass("searched")},focus:function(a,b){a.preventDefault(),""!=b.item.value?(i.val(b.item.label),j.val(b.item.value)):j.val("")},minLength:0,select:function(a,b){a.preventDefault(),""!=b.item.value?(i.val(b.item.label),j.val(b.item.value)):j.val(""),i.removeClass("searched")},source:function(a,b){i.addClass("searched"),j.val(""),Visualforce.remoting.Manager.invokeAction(controller+".getContactsByQ",a.term.replace(/ \((.+)\)$/,""),parentId,function(a){return null==a?void(window.location.href="/"+parentId):void b(a.length>0?jQuery.map(a,function(a){return{label:jQuery("<div>").html(a.Name).text()+" ("+(a.AccountId?jQuery("<div>").html(a.Account.Name).text():"No Account")+")",value:a.Id}}):[{label:"No Results",value:""}])
})}}).focus(function(){(""==i.val()||null==i.val())&&(i.hasClass("searched")||i.autocomplete("search",""))}),jQuery(".ui-autocomplete").css("padding",0));var k=e.find(".custom-alternatives");k.bind("keyup",function(a){var b=jQuery(this),c=b.parents(".component-body-item-field").find(".alternativeSelect");if(!a.shiftKey&&(13==a.keyCode||188==a.keyCode)&&isAlternativeObjEmpty){var d=jQuery(a.target).val();if(d.indexOf(",")>-1&&(d=d.substring(0,d.indexOf(","))),d=d.replace(/<\/?script>/g,"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),d.trim(),d.length&&0==c.find('option[value="'+d+'"]').length){var e=c.val();null==e&&(e=[]),c.append('<option value="'+d+'" class="custom">'+d+"</option>"),e.push(d),c.val(e),c.change()}jQuery(a.target).val("")}});var l=e.find(".noFancies input");l.bind("blur",function(){var a=jQuery(this);""==a.val()&&(a.val(a.attr("dataHolder")),a.addClass("dataHolder"))}),l.bind("focus",function(){var a=jQuery(this);a.hasClass("dataHolder")&&(a.val(""),a.removeClass("dataHolder"))})}"function"==typeof a&&a(f)})})},loadFinancialCriteria=function(a){var b="financialCriteria",c=jQuery("."+b),d=new componentDataCollection;d.getByParentIdAndType(parentId,b,function(){var f=new componentView({collection:d,el:c}),g=function(){var a=[],b="";return _.each(d.models,function(a){var c=a.get("AXIOM_BASE__BIO_Worksheet__c");b+=c+";"}),_.each(evList,function(c){var d=c.AXIOM_BASE__Contact__r.Name,e=c.Id,f=c.AXIOM_BASE__Roles__c;f&&(f=f.replace(crMap.FE,"FE")),null==b.match(e)&&f&&f.replace(/[,]/g," ").match(/\bFE\b/)&&a.push({Id:e,Name:d})}),a},h=function(){var a=g(),b=[];return 0==a.length&&b.push({modal:"error_message",text:"Please create evaluators with "+crMap.FE+" role, to create Financial Criteria"}),b};f.render({title:"Financial Criteria",type:b,options:{biow:g,financialConsiderations:financialConsiderations,fcSize:financialConsiderations.length,Description:"Only Evaluators assigned the role of "+crMap.FE+" can have financial criteria added for them.",hasLightbox:h},newItem:{},dependentComponents:["dangerZones","evaluators"],buttons:[{name:"",buttonClass:"help-button button",href:urlsMap[b.toLowerCase()],target:"_blank"}],events:{"click .Status .minus":function(a){a.preventDefault();var b=jQuery(a.target),c=b.parents(".component-button"),d=(c.find(".buttons"),c.find(".busy"),jQuery(b.attr("href")).find(".save-button"));d.hasClass("saving")||(e(a,"minus"),d.click())},"click .Status .plus":function(a){a.preventDefault();var b=jQuery(a.target),c=b.parents(".component-button"),d=(c.find(".buttons"),c.find(".busy"),jQuery(b.attr("href")).find(".save-button"));d.hasClass("saving")||(e(a,"plus"),d.click())},"click .modal-cancel-button":function(a){a.preventDefault();var b=jQuery(a.target),c=b.parents(".modal");c.modal("hide")}}},function(){$("#fin-Modal").modal().modal("hide"),c.find(".Financial_Considerations .view").each(function(){jQuery(this).html(jQuery(this).html().replace(/;/g,", "))});c.find(".component-body-item");_.each(d.models,function(a){var b=a.get("AXIOM_BASE__BIO_Worksheet__c");c.find(".toggle-"+b+":first .AXIOM_BASE__BIO_Worksheet__c span:first").show()});{var b=c.find(".Financial_Considerations select.AXIOM_BASE__Financial_Considerations__c");c.find(".Financial_Considerations select.AXIOM_BASE__Primary_Financial_Consideration__c")}b.change(function(){var a=jQuery(this),b=a.val(),c="<option></option>";b&&_.each(b,function(a){c+='<option value="'+a+'">'+a+"</option>"});var d=a.parents(".Financial_Considerations").find("select.AXIOM_BASE__Primary_Financial_Consideration__c");d.html(c),d.val(d.attr("current")),d.trigger("liszt:updated")}),b.change(),"function"==typeof a&&a(d)})});var e=function(a,b){var c="",d=jQuery(a.target).parents(".Status");d.hasClass("AXIOM_BASE__Budget_Status__c")?c="AXIOM_BASE__Budget_Status__c":d.hasClass("AXIOM_BASE__Value_Assignment_Status__c")&&(c="AXIOM_BASE__Value_Assignment_Status__c");var e=jQuery(a.target).siblings(".item"),d=e.parents("."+c),f=e.val();d.removeClass(f),f==b?(d.addClass("none"),e.val("none")):(d.addClass(b),e.val(b))}},loadPSCCriteria=function(a){var b="pscCriteria",c=jQuery("."+b),d=new componentDataCollection;d.getByParentIdAndType(parentId,b,function(){var e=new componentView({collection:d,el:c}),f=function(){var a=[];return _.each(evList,function(b){var c=b.AXIOM_BASE__Contact__r.Name,d=b.Id,e=b.AXIOM_BASE__Roles__c;e&&(e=e.replace(crMap.PT,"PT"),e=e.replace(crMap.PE,"PE"),e=e.replace(crMap.SE,"SE"),e=e.replace(crMap.CE,"CE"),e=e.replace(/[,]/g," ").match(/\bPT|PE|SE|CE\b/g),e&&a.push({Id:d,Name:c,Roles:e}))}),a};e.render({title:"P/S/C Criteria",type:b,options:{biow:f,pscAreas:pscAreas,pscImpacts:pscImpacts,Description:"Only Evaluators with a Role of "+crMap.CE+", "+crMap.PE+", "+crMap.PT+" or "+crMap.SE+" can have P/S/C Criteria added to them."},newItem:{},dependentComponents:["dangerZones","evaluators"],buttons:[{name:"",buttonClass:"help-button button",href:urlsMap[b.toLowerCase()],target:"_blank"}],events:{},duplicateErrorMsg:"The selected Evaluator already has an entry with this Description pick-list value, duplicates Descriptions for the same Evaluator are not allowed."},function(){c.find(".component-body-item");if(c.find(".AXIOM_BASE__Impact__c .view").each(function(){jQuery(this).html(jQuery(this).html().replace(/;/g,", "))}),_.each(d.models,function(a){c.find(".toggle-"+a.get("AXIOM_BASE__BIO_Worksheet__c")+":first .AXIOM_BASE__BIO_Worksheet__c span:first").show()}),c.find(".AXIOM_BASE__Description__c select.item option").attr("disabled",!0),c.find(".AXIOM_BASE__BIO_Worksheet__c select").change(function(){var a=jQuery(this),b=a.find('option[value="'+a.val()+'"]').attr("roles");desc=a.parents(".component-body-item-field").siblings(".AXIOM_BASE__Description__c"),desc.find("select.item option").attr("disabled",!0),b&&(_.each(b.split(","),function(a){"PT"==a||"PE"==a?desc.find('select.item option[value="Product"]').attr("disabled",null):"SE"==a?desc.find('select.item option[value="Support"]').attr("disabled",null):"CE"==a&&desc.find('select.item option[value="Company"]').attr("disabled",null)}),desc.find("select").val(""),desc.find("select-wrapper").css(),noFancies||desc.find("select").trigger("liszt:updated"))}),pscAreas){var b=c.find(".AXIOM_BASE__Description__c select");b.each(function(){var a=jQuery(this);a.val(a.attr("current"))})}"function"==typeof a&&a(d)})})},loadModalCommonalities=function(callback){var type="Modal_Commonalities",el=jQuery("#ap-commonalities-Modal"),checkSelectedButton=function(){var a=!1;$(".comCheckbox").each(function(){$(this).is(":checked")&&(a=!0)}),a?$(".com-add-selected").removeClass("disabled"):$(".com-add-selected").addClass("disabled")},componentCollection=new componentDataCollection;componentCollection.getByAccountIdAndType(parentId,type,"All",function(){var componentBodyView=new componentView({collection:componentCollection,el:el});componentBodyView.renderModal({type:type,dependentComponents:[],events:{"change #com_filter":function(a){a.preventDefault();var b=this,c=jQuery("#com_filter").val();b.collection.getByAccountIdAndType(parentId,"Modal_Commonalities",c,function(){b.renderModal()})},"click .com-add-selected":function(e){if(e.preventDefault(),!$(".com-add-selected").hasClass("disabled")){var ids="";$(".comCheckbox:checked").each(function(){ids+=","+$(this).attr("id")}),ids=ids.replace(",",""),ids=ids.replace(/_([^,]*)$/,""),$(".comBusy").addClass("busy"),$("#ap-commonalities-Modal .component-button .button").hide(),eval(controller).pullInCommonalities(ids,parentId,accountId,function(a){"SUCCESS"==a?$(".commonalities").find(".refresh-button").click():(alert(a),$(".comBusy").removeClass("busy"),$("#ap-commonalities-Modal .component-button .button").show())})}},"click #com-modal-check-toggle":function(){$("#com-modal-check-toggle").is(":checked")?$(".comCheckbox").attr("checked","checked"):$(".comCheckbox").removeAttr("checked"),checkSelectedButton()},"click .comCheckbox":function(){checkSelectedButton()},"click .modal-cancel-button":function(){$("#ap-commonalities-Modal").modal("hide")}}})})},loadModalBusinessStates=function(){var a="Modal_BusinessStates",b=jQuery("#ap-bs-Modal"),c=new componentDataCollection;c.getByAccountIdAndType(parentId,a,"All",function(){var d=new componentView({collection:c,el:b});d.renderModal({type:a,dependentComponents:[],events:{"change #bs_filter":function(a){a.preventDefault();var b=this,c=jQuery("#bs_filter").val();b.collection.getByAccountIdAndType(parentId,"Modal_BusinessStates",c,function(){b.renderModal()})},"click .modal-cancel-button":function(){$("#ap-bs-Modal").modal("hide")},"click .bs-radio":function(){$(".bs-addSelected").removeClass("disabled")},"click .bs-addSelected":function(a){if(a.preventDefault(),!$(".bs-addSelected").hasClass("disabled")){$(".businessStates .new-button").click();var b=$("input[name=pick]:checked").closest("tr").attr("id"),c=$(".AXIOM_BASE__Area__c .view",$("#"+b)).html(),d=$(".AXIOM_BASE__Description__c .view",$("#"+b)).html(),e=$(".AXIOM_BASE__Impact__c .view",$("#"+b)).html(),f=$(".AXIOM_BASE__ImpactDescription__c .view",$("#"+b)).html(),g=$(".AXIOM_BASE__Gap__c .view",$("#"+b)).html(),h=e.split(";");$(".businessStates .AXIOM_BASE__Area__c .chzn-results li").each(function(){$(this).html()==c&&$(this).trigger("mouseup")}),$('.businessStates select[name="AXIOM_BASE__Area__c"]').val(c),$(".businessStates .AXIOM_BASE__Description__c textarea").val(d),$('.businessStates select[name="AXIOM_BASE__Impact__c"] option').each(function(){$(this).removeAttr("selected");for(var a=0;a<h.length;a++)$(this).val()==h[a]&&$(this).attr("selected","selected")}),noFancies||$('.businessStates select[name="AXIOM_BASE__Impact__c"]').trigger("liszt:updated"),$(".businessStates .AXIOM_BASE__ImpactDescription__c textarea").val(f),$(".businessStates .AXIOM_BASE__Gap__c textarea").val(g),$("#ap-bs-Modal").modal("hide")}}}})})},loadModalCurrentPSCF=function(callback){var type="Modal_CurrentPSCF",el=jQuery("#ap-currentPSCF-Modal"),checkSelectedButton=function(){var a=!1;$(".curPSCFCheckbox").each(function(){$(this).is(":checked")&&(a=!0)}),a?$(".curPSCF-add-selected").removeClass("disabled"):$(".curPSCF-add-selected").addClass("disabled")},componentCollection=new componentDataCollection;componentCollection.getByAccountIdAndType(parentId,type,"All",function(){var componentBodyView=new componentView({collection:componentCollection,el:el});componentBodyView.renderModal({type:type,dependentComponents:[],events:{"change #currentPSCF_filter":function(a){a.preventDefault();var b=this,c=jQuery("#currentPSCF_filter").val();b.collection.getByAccountIdAndType(parentId,"Modal_CurrentPSCF",c,function(){b.renderModal()})},"click .modal-cancel-button":function(){$("#ap-currentPSCF-Modal").modal("hide")},"click #curPSCF-modal-check-toggle":function(){$("#curPSCF-modal-check-toggle").is(":checked")?$(".curPSCFCheckbox").attr("checked","checked"):$(".curPSCFCheckbox").removeAttr("checked"),checkSelectedButton()},"click .curPSCF-add-selected":function(e){if(e.preventDefault(),!$(".curPSCF-add-selected").hasClass("disabled")){var ids="";$(".curPSCFCheckbox:checked").each(function(){ids+=","+$(this).attr("id")}),ids=ids.replace(",",""),ids=ids.replace(/_([^,]*)$/,""),$(".curPSCFBusy").addClass("busy"),$("#ap-currentPSCF-Modal .component-button .button").hide(),eval(controller).pullInCurPSCF(ids,parentId,accountId,function(a){"SUCCESS"==a?$(".currentPSCF").find(".refresh-button").click():(alert(a),$(".curPSCFBusy").removeClass("busy"),$("#ap-currentPSCF-Modal .component-button .button").show())})}},"click .curPSCFCheckbox":function(){checkSelectedButton()}}})})};var css={},cssLoaded=0,totalCSS=0,pdfCSS,evLoad=!1,evList=[],firstTime=!0,componentsLoaded=0,totalComponents=0,done=!1,canCreateCCEvaluator=!1;preBoot=function(){if("undefined"!=typeof AXIOMOMD&&(controller="AXIOMOMD."+controller),OmdConf.isDeveloperMode()){for(x in tempDir)++totalCSS;for(x in tempDir)getCSS(x)}else jQuery.ajax({url:cssURL,success:function(a){a=a.replace(/url\(\'\/resource\/axiom_base__images\//g,"url('"+imagePrefix),pdfCSS+=a,pdfCSS="<style>"+pdfCSS+"</style>",boot()}})},boot=function(){try{++totalComponents,loadParentObject(function(){try{++totalComponents,loadEvaluators(function(){evLoad=!0,postPageLoad()})}catch(a){postPageLoad()}try{++totalComponents,loadDecisionStages(function(){})}catch(a){postPageLoad()}try{++totalComponents,loadActionRegisters(function(){})}catch(a){postPageLoad()}try{++totalComponents,loadCurrentPSCF(function(){})}catch(a){postPageLoad()}try{++totalComponents,loadCommonalities(function(){})}catch(a){postPageLoad()}})}catch(a){postPageLoad()}};